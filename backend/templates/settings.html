{% extends "base.html" %}

{% block title %}Settings - Mindful Eating Agent{% endblock %}

{% block content %}
<header>
    <div class="header-content">
        <div class="logo">üçΩÔ∏è Mindful Eating Agent</div>
        <nav>
            <span class="user-greeting">Welcome, {{ user_name }}!</span>
            <a href="{{ url_for('chat') }}">Chat</a>
            <a href="{{ url_for('calendar') }}">Calendar</a>
            <a href="{{ url_for('settings') }}" class="active">Settings</a>
            <a href="{{ url_for('logout') }}">Logout</a>
        </nav>
    </div>
</header>

<div class="settings-container">
    <div class="settings-card">
        <h2>‚öôÔ∏è Account Settings</h2>
        <p>Manage your profile and nutrition goals</p>

        {% if success %}
        <div class="success-message">
            ‚úÖ {{ success }}
        </div>
        {% endif %}

        {% if error %}
        <div class="error">{{ error }}</div>
        {% endif %}

        <!-- Current Goals Display -->
        <div class="settings-section">
            <h3>üìä Current Daily Goals</h3>
            <div class="current-goals">
                <div class="goal-item">
                    <div class="label">Calories</div>
                    <div class="value">{{ goals.daily_calories }}</div>
                    <div class="unit">kcal</div>
                </div>
                <div class="goal-item">
                    <div class="label">Protein</div>
                    <div class="value">{{ goals.daily_protein }}</div>
                    <div class="unit">grams</div>
                </div>
                <div class="goal-item">
                    <div class="label">Carbs</div>
                    <div class="value">{{ goals.daily_carbs }}</div>
                    <div class="unit">grams</div>
                </div>
                <div class="goal-item">
                    <div class="label">Fat</div>
                    <div class="value">{{ goals.daily_fat }}</div>
                    <div class="unit">grams</div>
                </div>
            </div>
        </div>

        <!-- Update Goals Form -->
        <div class="settings-section">
            <h3>‚úèÔ∏è Update Your Goals</h3>
            <form method="POST" action="{{ url_for('settings') }}">
                <div class="form-row">
                    <div class="form-group">
                        <label for="daily_calories">Daily Calories</label>
                        <input type="number" id="daily_calories" name="daily_calories"
                            value="{{ goals.daily_calories }}" min="1000" max="5000" required>
                        <small>Recommended: 1500-2500 kcal</small>
                    </div>

                    <div class="form-group">
                        <label for="daily_protein">Daily Protein (g)</label>
                        <input type="number" id="daily_protein" name="daily_protein" value="{{ goals.daily_protein }}"
                            min="50" max="300" required>
                        <small>Recommended: 80-150g</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="daily_carbs">Daily Carbs (g)</label>
                        <input type="number" id="daily_carbs" name="daily_carbs" value="{{ goals.daily_carbs }}"
                            min="50" max="500" required>
                        <small>Recommended: 150-300g</small>
                    </div>

                    <div class="form-group">
                        <label for="daily_fat">Daily Fat (g)</label>
                        <input type="number" id="daily_fat" name="daily_fat" value="{{ goals.daily_fat }}" min="20"
                            max="200" required>
                        <small>Recommended: 40-80g</small>
                    </div>
                </div>

                <button type="submit" class="btn">üíæ Save Changes</button>
            </form>
        </div>

        <!-- Account Information -->
        <div class="settings-section">
            <h3>üë§ Account Information</h3>
            <div class="form-group">
                <label>Name</label>
                <input type="text" value="{{ user_name }}" disabled>
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" value="{{ user_email }}" disabled>
            </div>
            <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.5rem;">
                To change your name or email, please contact support.
            </p>
        </div>
    </div>
</div>

<style>
    small {
        display: block;
        color: var(--text-light);
        font-size: 0.8rem;
        margin-top: 0.3rem;
    }

    input:disabled {
        background: var(--bg-secondary);
        cursor: not-allowed;
        opacity: 0.7;
    }
</style>
{% endblock %}