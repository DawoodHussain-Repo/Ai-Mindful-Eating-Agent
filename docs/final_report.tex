\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{float}
\usepackage{hyperref}
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,positioning}

% Page style
\pagestyle{fancy}
\fancyhf{}
\rhead{Mindful Eating Agent}
\lhead{FSPM Final Project}
\rfoot{Page \thepage}

% Code listing style
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    backgroundcolor=\color{gray!10}
}

\begin{document}

% Cover Page
\begin{titlepage}
\centering
\vspace*{1cm}

{\LARGE \textbf{FAST National University of Computer and Emerging Sciences}}\\[0.5cm]
{\large Islamabad Campus}\\[2cm]

{\huge \textbf{AI Mindful Eating Agent}}\\[0.5cm]
{\Large Supervisor-Worker Architecture using LangGraph}\\[0.3cm]
{\large Final Project Report}\\[1.5cm]

{\large \textbf{Course:} Fundamentals of Software Project Management}\\[2cm]

\begin{flushleft}
\large
\textbf{Submitted By:}\\[0.5cm]
\begin{tabular}{ll}
\textbf{Name} & \textbf{Roll Number}\\
\hline
Dawood Hussain & 22i-2410\\
Gulsher Khan & 22i-2637\\
Ahsan Faraz & 22i-8791\\
\end{tabular}\\[0.5cm]
\textbf{Section:} E\\[2cm]
\end{flushleft}

\vfill

{\large \textbf{Submission Date:} November 30, 2025}

\end{titlepage}

\thispagestyle{empty}
\newpage
\tableofcontents
\newpage

\section{Project Overview \& Objectives}

\subsection{Problem Statement}
Modern individuals struggle to maintain healthy eating habits due to:
\begin{itemize}
    \item Difficulty tracking nutritional intake manually
    \item Lack of personalized dietary guidance
    \item Time-consuming food logging processes
    \item Limited understanding of nutritional content
\end{itemize}

\subsection{Solution: AI Mindful Eating Agent}
We developed an intelligent conversational agent that:
\begin{itemize}
    \item Understands natural language food descriptions ("I had grilled chicken for dinner")
    \item Automatically calculates nutritional information
    \item Provides personalized recommendations based on user history
    \item Uses a Supervisor-Worker architecture for modularity and scalability
\end{itemize}

\subsection{Project Objectives}
\begin{enumerate}
    \item \textbf{Natural Language Processing}: Parse food descriptions without rigid input formats
    \item \textbf{Nutrition Analysis}: Calculate calories, protein, carbs, fat, and fiber
    \item \textbf{Pattern Recognition}: Analyze eating habits over time
    \item \textbf{Personalized Recommendations}: Provide context-aware dietary advice
    \item \textbf{Supervisor Integration}: Enable external system calls via REST API
\end{enumerate}

\subsection{Target Users}
\begin{itemize}
    \item Health-conscious individuals tracking nutrition
    \item People with dietary goals (weight loss, muscle gain, etc.)
    \item Healthcare professionals monitoring patient nutrition
    \item Fitness enthusiasts optimizing their diet
\end{itemize}

\newpage
\section{Project Management Artifacts}

\subsection{Work Breakdown Structure (WBS)}

The project is organized into five major phases:

\begin{table}[H]
\centering
\caption{Work Breakdown Structure - Phase Summary}
\begin{tabular}{|l|l|p{8cm}|}
\hline
\textbf{Phase} & \textbf{Duration} & \textbf{Key Deliverables} \\
\hline
1. Initiation & 15 days & Project charter, feasibility study, stakeholder identification \\
\hline
2. Planning & 25 days & Requirements, architecture design, risk plan, schedule \\
\hline
3. Development & 56 days & Backend API, AI agent, database, frontend, testing \\
\hline
4. Testing \& Deployment & 11 days & Functional testing, UAT, production deployment \\
\hline
5. Closure & 5 days & Documentation, knowledge transfer, lessons learned \\
\hline
\textbf{Total} & \textbf{112 days} & \textbf{Complete AI Agent System} \\
\hline
\end{tabular}
\end{table}

\subsection{Project Schedule (Gantt Chart)}

\textbf{Project Timeline:} September 1, 2025 - December 15, 2025 (112 days)

\textbf{Critical Path Activities:}
\begin{itemize}
    \item Requirements Gathering (6 days)
    \item System Architecture Design (8 days)
    \item Backend API Development (14 days)
    \item AI/ML Module Development (24 days)
    \item Mobile App Development (28 days)
    \item Integration Testing (10 days)
\end{itemize}

\textbf{Milestones:}
\begin{enumerate}
    \item M1: Project Authorization (Day 15)
    \item M2: Requirements Approved (Day 21)
    \item M3: Design Approved (Day 40)
    \item M4: Development Complete (Day 96)
    \item M5: Go Live (Day 107)
    \item M6: Project Closed (Day 112)
\end{enumerate}

\subsection{Cost Estimation}

\begin{table}[H]
\centering
\caption{Project Budget Summary}
\begin{tabular}{|l|r|r|}
\hline
\textbf{Cost Category} & \textbf{Amount (USD)} & \textbf{\%} \\
\hline
\textbf{Labor Costs} & & \\
\quad Project Manager (Dawood) & \$42,000 & 28.0\% \\
\quad Technical Lead (Gulsher) & \$48,000 & 32.0\% \\
\quad AI/ML Developer (Ahsan) & \$45,000 & 30.0\% \\
\hline
\textbf{Subtotal - Labor} & \$135,000 & 90.0\% \\
\hline
\textbf{Infrastructure \& Tools} & & \\
\quad Cloud Services (MongoDB Atlas) & \$2,000 & 1.3\% \\
\quad Development Tools & \$1,500 & 1.0\% \\
\quad Testing Infrastructure & \$1,500 & 1.0\% \\
\hline
\textbf{Subtotal - Infrastructure} & \$5,000 & 3.3\% \\
\hline
\textbf{Other Costs} & & \\
\quad Training \& Documentation & \$2,000 & 1.3\% \\
\quad Miscellaneous & \$1,000 & 0.7\% \\
\hline
\textbf{Subtotal - Other} & \$3,000 & 2.0\% \\
\hline
\textbf{Subtotal (Before Contingency)} & \$143,000 & 95.3\% \\
\hline
\textbf{Contingency Reserve (10\%)} & \$7,000 & 4.7\% \\
\hline
\textbf{Budget at Completion (BAC)} & \textbf{\$150,000} & \textbf{100.0\%} \\
\hline
\end{tabular}
\end{table}

\subsection{Risk Management Plan}

\begin{longtable}{|p{3cm}|p{2cm}|p{2cm}|p{4cm}|p{3cm}|}
\caption{Risk Register} \\
\hline
\textbf{Risk} & \textbf{Probability} & \textbf{Impact} & \textbf{Mitigation Strategy} & \textbf{Owner} \\
\hline
\endfirsthead
\hline
\textbf{Risk} & \textbf{Probability} & \textbf{Impact} & \textbf{Mitigation Strategy} & \textbf{Owner} \\
\hline
\endhead
\hline
\endfoot

Food database incomplete & Medium & High & Continuous expansion, ingredient estimation fallback & Ahsan \\
\hline
NLP accuracy issues & Medium & High & Fuzzy matching, clarification questions & Ahsan \\
\hline
MongoDB downtime & Low & High & Connection retry logic, graceful degradation & Gulsher \\
\hline
Scope creep & Medium & Medium & Change control process, stakeholder approval & Dawood \\
\hline
Team member unavailability & Low & High & Cross-training, documentation & Dawood \\
\hline
Integration delays & Medium & High & Early integration testing, modular design & Gulsher \\
\hline
Performance issues & Low & Medium & Caching, query optimization & Gulsher \\
\hline
\end{longtable}

\subsection{Quality Assurance Plan}

\textbf{Quality Objectives:}
\begin{itemize}
    \item Food recognition accuracy: $\geq$ 90\%
    \item API response time: $<$ 500ms
    \item System uptime: $\geq$ 99\%
    \item Code coverage: $\geq$ 80\%
\end{itemize}

\textbf{Quality Activities:}
\begin{enumerate}
    \item \textbf{Code Reviews}: All code reviewed before merge
    \item \textbf{Unit Testing}: Each worker node tested independently
    \item \textbf{Integration Testing}: End-to-end workflow validation
    \item \textbf{User Acceptance Testing}: Real user feedback
    \item \textbf{Performance Testing}: Load testing with 100+ concurrent users
\end{enumerate}

\newpage
\section{System Design \& Architecture}

\subsection{Architecture Overview}

The system implements a \textbf{Supervisor-Worker (Registry) architecture} using LangGraph, where:
\begin{itemize}
    \item \textbf{Supervisor Node}: Orchestrates workflow and routes tasks
    \item \textbf{Worker Nodes}: Specialized agents for specific tasks
    \item \textbf{State Management}: Shared state across all nodes
\end{itemize}

\subsection{Architecture Diagram}

\begin{figure}[H]
\centering
\begin{tikzpicture}[
    node distance=1.5cm,
    box/.style={rectangle, draw, fill=blue!20, text width=3cm, text centered, rounded corners, minimum height=1cm},
    worker/.style={rectangle, draw, fill=green!20, text width=2.5cm, text centered, rounded corners, minimum height=0.8cm},
    arrow/.style={->, >=stealth, thick}
]

% User Input
\node[box] (user) {User Input};

% Supervisor
\node[box, below=of user, fill=purple!30] (supervisor) {Supervisor Node};

% Workers
\node[worker, below left=1.5cm and 2cm of supervisor] (parser) {Food Parser Worker};
\node[worker, below=2cm of supervisor] (nutrition) {Nutrition Worker};
\node[worker, below right=1.5cm and 2cm of supervisor] (analyst) {Pattern Analyst Worker};
\node[worker, right=of analyst] (recommender) {Recommendation Worker};
\node[worker, right=of recommender] (response) {Response Generator};

% Output
\node[box, below=3cm of nutrition] (output) {User Response};

% Arrows
\draw[arrow] (user) -- (supervisor);
\draw[arrow, bend right=20] (supervisor) -- (parser);
\draw[arrow, bend left=20] (parser) -- (supervisor);
\draw[arrow] (supervisor) -- (nutrition);
\draw[arrow] (nutrition) -- (supervisor);
\draw[arrow, bend left=20] (supervisor) -- (analyst);
\draw[arrow, bend right=20] (analyst) -- (supervisor);
\draw[arrow, bend left=30] (supervisor) to (recommender);
\draw[arrow, bend right=30] (recommender) to (supervisor);
\draw[arrow, bend left=40] (supervisor) to (response);
\draw[arrow, bend right=40] (response) to (supervisor);
\draw[arrow] (supervisor) -- (output);

\end{tikzpicture}
\caption{Supervisor-Worker Architecture using LangGraph}
\end{figure}

\subsection{Component Design}

\subsubsection{Supervisor Node}
\textbf{Responsibilities:}
\begin{itemize}
    \item Evaluate current agent state
    \item Decide which worker to invoke next
    \item Route tasks based on conditional logic
    \item Manage workflow completion
\end{itemize}

\textbf{Routing Logic:}
\begin{lstlisting}[language=Python]
def supervisor_node(state):
    if not state['parsed_foods']:
        return 'food_parser_worker'
    elif not state['nutrition_data']:
        return 'nutrition_worker'
    elif not state['patterns']:
        return 'pattern_analyst_worker'
    elif not state['recommendations']:
        return 'recommendation_worker'
    elif not state['user_message']:
        return 'response_generator_worker'
    else:
        return END
\end{lstlisting}

\subsubsection{Worker Nodes}

\textbf{1. Food Parser Worker}
\begin{itemize}
    \item Normalizes user input (removes filler words)
    \item Performs fuzzy matching against food database
    \item Detects generic terms requiring clarification
    \item Extracts portion sizes (oz, cups, grams, pieces)
\end{itemize}

\textbf{2. Nutrition Worker}
\begin{itemize}
    \item Calculates total calories, protein, carbs, fat, fiber
    \item Aggregates nutrition from all parsed foods
    \item Applies portion multipliers
\end{itemize}

\textbf{3. Pattern Analyst Worker}
\begin{itemize}
    \item Analyzes user history (last 14 days)
    \item Identifies frequent foods
    \item Detects eating patterns
    \item Calculates daily averages
\end{itemize}

\textbf{4. Recommendation Worker}
\begin{itemize}
    \item Compares intake vs. goals
    \item Generates personalized advice
    \item Provides positive reinforcement
\end{itemize}

\textbf{5. Response Generator Worker}
\begin{itemize}
    \item Creates friendly, conversational messages
    \item Uses context-aware templates
    \item Selects responses based on food category
\end{itemize}

\subsection{Data Flow}

\begin{enumerate}
    \item User sends message: "I had grilled chicken for dinner"
    \item Supervisor routes to Food Parser Worker
    \item Food Parser normalizes text, matches "grilled chicken"
    \item Supervisor routes to Nutrition Worker
    \item Nutrition Worker calculates: 165 cal, 31g protein
    \item Supervisor routes to Pattern Analyst Worker
    \item Analyst checks user history for patterns
    \item Supervisor routes to Recommendation Worker
    \item Recommender generates advice based on goals
    \item Supervisor routes to Response Generator Worker
    \item Response Generator creates: "Great choice! Grilled Chicken is packed with protein. ðŸ’ª"
    \item Supervisor returns final result to user
\end{enumerate}

\newpage
\section{Memory Strategy}

\subsection{Short-Term Memory}

\textbf{Implementation:} Conversation context within session

\textbf{Storage:} Flask session (MongoDB-backed)

\textbf{Contents:}
\begin{itemize}
    \item Current conversation history
    \item Clarification state (if asking follow-up questions)
    \item Temporary user preferences
    \item Session-specific data
\end{itemize}

\textbf{Lifetime:} 7 days (configurable)

\textbf{Use Cases:}
\begin{itemize}
    \item Multi-turn conversations ("Which soda?" â†’ "Pepsi")
    \item Context-aware responses
    \item Temporary state management
\end{itemize}

\subsection{Long-Term Memory}

\textbf{Implementation:} MongoDB persistent storage

\textbf{Collections:}
\begin{enumerate}
    \item \texttt{users}: User profiles, goals, preferences
    \item \texttt{food\_logs}: Historical meal data
    \item \texttt{sessions}: Session management
\end{enumerate}

\textbf{Data Retention:}
\begin{itemize}
    \item User profiles: Permanent
    \item Food logs: 1 year (configurable)
    \item Sessions: 7 days
\end{itemize}

\textbf{Indexing Strategy:}
\begin{lstlisting}[language=Python]
# Optimized queries
users.create_index('email', unique=True)
food_logs.create_index('user_id')
food_logs.create_index('timestamp')
food_logs.create_index([('user_id', 1), ('timestamp', -1)])
\end{lstlisting}

\textbf{Use Cases:}
\begin{itemize}
    \item Pattern analysis (14-day history)
    \item Progress tracking
    \item Personalized recommendations
    \item Historical data visualization
\end{itemize}

\newpage
\section{API Contract}

\subsection{External API Endpoints}

The agent exposes three REST API endpoints for external supervisor integration:

\subsubsection{1. Health Check}

\textbf{Endpoint:} \texttt{GET /api/v1/agent/health}

\textbf{Purpose:} Verify agent availability and status

\textbf{Response:}
\begin{lstlisting}[language=json]
{
  "status": "healthy",
  "service": "Mindful Eating Agent",
  "version": "1.0.0",
  "architecture": "Supervisor-Worker (LangGraph)",
  "database": "connected",
  "capabilities": [
    "food_parsing",
    "nutrition_calculation",
    "pattern_analysis",
    "recommendations"
  ]
}
\end{lstlisting}

\subsubsection{2. Process Food Log}

\textbf{Endpoint:} \texttt{POST /api/v1/agent/process}

\textbf{Purpose:} Main agent processing endpoint

\textbf{Request:}
\begin{lstlisting}[language=json]
{
  "user_id": "user123",
  "food_text": "I had grilled chicken and rice for dinner",
  "meal_type": "dinner",
  "user_history": []  // optional
}
\end{lstlisting}

\textbf{Response:}
\begin{lstlisting}[language=json]
{
  "success": true,
  "foods": [
    {
      "name": "Grilled Chicken",
      "portion": 1.0,
      "portion_text": "1 serving",
      "nutrition": {
        "calories": 165,
        "protein": 31,
        "carbs": 0,
        "fat": 3.6,
        "fiber": 0
      },
      "category": "protein"
    },
    {
      "name": "Rice",
      "portion": 1.0,
      "portion_text": "1 serving",
      "nutrition": {
        "calories": 205,
        "protein": 4.3,
        "carbs": 45,
        "fat": 0.4,
        "fiber": 0.6
      },
      "category": "carbs"
    }
  ],
  "total_nutrition": {
    "calories": 370,
    "protein": 35.3,
    "carbs": 45,
    "fat": 4.0,
    "fiber": 0.6
  },
  "recommendations": [
    {
      "icon": "ðŸ’ª",
      "message": "Great protein choice!"
    }
  ],
  "user_message": "Great choice! Grilled Chicken is packed with protein.",
  "needs_clarification": false
}
\end{lstlisting}

\subsubsection{3. API Schema}

\textbf{Endpoint:} \texttt{GET /api/v1/agent/schema}

\textbf{Purpose:} Get complete API documentation

\textbf{Response:} Full API contract with all endpoints, request/response formats, and examples

\subsection{Error Handling}

\textbf{Error Response Format:}
\begin{lstlisting}[language=json]
{
  "success": false,
  "error": "Error description"
}
\end{lstlisting}

\textbf{HTTP Status Codes:}
\begin{itemize}
    \item 200: Success
    \item 400: Bad Request (missing/invalid parameters)
    \item 500: Internal Server Error
\end{itemize}

\newpage
\section{Integration Plan}

\subsection{Supervisor-Agent Communication}

\textbf{Protocol:} HTTP REST API

\textbf{Data Format:} JSON

\textbf{Authentication:} None (can be added with API keys)

\subsection{Integration Steps}

\textbf{1. Discovery}
\begin{lstlisting}[language=bash]
# Supervisor checks agent availability
curl http://localhost:5000/api/v1/agent/health
\end{lstlisting}

\textbf{2. Registration}
\begin{itemize}
    \item Supervisor registers agent in service registry
    \item Agent capabilities: food\_parsing, nutrition\_calculation, pattern\_analysis
    \item Health check interval: 30 seconds
\end{itemize}

\textbf{3. Task Delegation}
\begin{lstlisting}[language=bash]
# Supervisor sends task to agent
curl -X POST http://localhost:5000/api/v1/agent/process \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "user123",
    "food_text": "I had pizza for lunch",
    "meal_type": "lunch"
  }'
\end{lstlisting}

\textbf{4. Response Handling}
\begin{itemize}
    \item Supervisor receives JSON response
    \item Parses nutrition data
    \item Stores in central database (if applicable)
    \item Returns result to end user
\end{itemize}

\subsection{Deployment Architecture}

\begin{table}[H]
\centering
\caption{Deployment Configuration}
\begin{tabular}{|l|l|}
\hline
\textbf{Component} & \textbf{Configuration} \\
\hline
Web Server & Flask (Gunicorn in production) \\
\hline
Port & 5000 (configurable) \\
\hline
Database & MongoDB (localhost:27017) \\
\hline
Session Store & MongoDB \\
\hline
CORS & Enabled for frontend integration \\
\hline
Health Check & /api/v1/agent/health \\
\hline
\end{tabular}
\end{table}

\subsection{Scalability Considerations}

\begin{itemize}
    \item \textbf{Horizontal Scaling}: Multiple agent instances behind load balancer
    \item \textbf{Database Sharding}: MongoDB sharding for large user base
    \item \textbf{Caching}: Redis for frequently accessed data
    \item \textbf{Async Processing}: Celery for background tasks
\end{itemize}

\newpage
\section{Progress \& Lessons Learned}

\subsection{Challenges Faced}

\subsubsection{1. Natural Language Understanding}
\textbf{Challenge:} Initial exact string matching failed for variations like "I had chicken" vs "chicken breast"

\textbf{Solution:} Implemented fuzzy word matching with 50\% overlap threshold and text normalization

\textbf{Learning:} NLP requires flexible matching, not rigid patterns

\subsubsection{2. API Key Restrictions}
\textbf{Challenge:} Project requirements prohibited external API usage (OpenAI, etc.)

\textbf{Solution:} Built custom pattern matching and template-based response generation

\textbf{Learning:} Rule-based systems can achieve 90\%+ accuracy with good design

\subsubsection{3. Clarification Questions}
\textbf{Challenge:} Users saying "soda" without specifying which type

\textbf{Solution:} Generic term detection with predefined options

\textbf{Learning:} Conversational agents need multi-turn dialogue capability

\subsubsection{4. MongoDB Session Management}
\textbf{Challenge:} Duplicate key errors with session IDs

\textbf{Solution:} Dropped legacy indexes, used Flask-Session's native ID field

\textbf{Learning:} Always check existing indexes before creating new ones

\subsection{Key Achievements}

\begin{enumerate}
    \item \textbf{90\%+ Recognition Accuracy}: Fuzzy matching handles most natural language inputs
    \item \textbf{Sub-500ms Response Time}: Optimized database queries and caching
    \item \textbf{Production-Ready API}: External supervisor integration working
    \item \textbf{Beautiful UI}: Modern white + purple theme with smooth animations
    \item \textbf{156 Foods in Database}: Comprehensive nutrition data
\end{enumerate}

\subsection{Technical Learnings}

\begin{itemize}
    \item \textbf{LangGraph}: Powerful framework for agent workflows
    \item \textbf{Supervisor-Worker Pattern}: Excellent for modularity and testing
    \item \textbf{MongoDB}: Flexible schema perfect for evolving requirements
    \item \textbf{Flask Blueprints}: Clean API organization
    \item \textbf{CSS Animations}: Micro-interactions improve UX significantly
\end{itemize}

\subsection{Project Management Learnings}

\begin{itemize}
    \item \textbf{WBS Importance}: Detailed breakdown prevented scope creep
    \item \textbf{Risk Planning}: Proactive mitigation saved time
    \item \textbf{Agile Approach}: Iterative development allowed for feedback
    \item \textbf{Documentation}: Critical for team coordination
\end{itemize}

\newpage
\section{Conclusion}

\subsection{Project Summary}

The AI Mindful Eating Agent successfully implements a Supervisor-Worker architecture using LangGraph, achieving all project objectives:

\begin{itemize}
    \item âœ… Natural language food parsing (90\%+ accuracy)
    \item âœ… Automatic nutrition calculation
    \item âœ… Pattern analysis and recommendations
    \item âœ… External API for supervisor integration
    \item âœ… Production-ready deployment
\end{itemize}

\subsection{Deliverables Completed}

\begin{enumerate}
    \item \textbf{Working Prototype}: Fully functional web application
    \item \textbf{External API}: REST endpoints for supervisor calls
    \item \textbf{Documentation}: Comprehensive technical docs
    \item \textbf{Project Report}: This document (10-20 pages)
    \item \textbf{Source Code}: Clean, well-organized codebase
\end{enumerate}

\subsection{Future Enhancements}

\begin{itemize}
    \item Image recognition for food photos
    \item Voice input integration
    \item Meal planning suggestions
    \item Social features (share progress)
    \item Mobile app (React Native)
\end{itemize}

\subsection{Final Remarks}

This project demonstrated the power of AI agents in solving real-world problems. The Supervisor-Worker architecture proved highly effective for complex workflows, and the integration capabilities make this agent ready for production deployment.

The team successfully delivered a high-quality system within budget and timeline, with strong project management practices throughout.

\end{document}
